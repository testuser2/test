var RiseVision=RiseVision||{};RiseVision.Weather={};RiseVision.Weather.Settings={};RiseVision.Weather.Settings=function(){this.settings=new RiseVision.Common.Settings};
RiseVision.Weather.Settings.prototype.init=function(){var b=this;$("input[name='layout']").change(function(){var a=$(this).val();"current"==a?$(".forecast").hide():$(".forecast").show();"three-day"==a?$(".current").hide():$(".current").show()});$("#address").on("change",function(a){"custom"==$(this).val()?$(".custom-address").show():$(".custom-address").hide()});$("#description").on("change",function(a){"custom"==$(this).val()?$(".custom-description").show():$(".custom-description").hide()});$("#show-humidity").on("click",
function(a){$(this).is(":checked")?$(".other").show():$(".other").hide()});$("#save").on("click",function(){b.getSettings()});$("#cancel, #settings-close").on("click",function(){gadgets.rpc.call("","rscmd_closeSettings",null)});$("#help").on("click",function(){window.open("http://www.risevision.com/help/users/what-are-gadgets/premium-gadgets/rise-vision-weather/","_blank")});$("#settings-alert").hide();gadgets.rpc.call("","rscmd_getAdditionalParams",function(a){if(a){var c=new gadgets.Prefs;a=JSON.parse(a);
b.result=a;$("input[type='radio'][name='layout']").each(function(){if($(this).val()==c.getString("layout"))return $(this).attr("checked","checked"),"current"==c.getString("layout")?$(".forecast").hide():$(".forecast").show(),"three-day"==c.getString("layout")?$(".current").hide():$(".current").show(),!1});$("#address").val(c.getString("address"));$("#custom-address").val(c.getString("custom-address"));$("#description").val(c.getString("description"));$("#show-humidity").attr("checked",c.getBool("show-humidity"));
$("#unit").val(c.getString("unit"));$("#wind-speed").val(c.getString("wind-speed"));$("#background-color").val(c.getString("background-color"));$("#terms").attr("checked",c.getBool("terms"));$("#layout-url").val(a["layout-url"]);$("#custom-description").val(a["custom-description"]);$("#current-temp-font").fontPicker({"i18n-prefix":"current-temp-font",defaults:{font:a["current-temp-font"],"font-url":a["current-temp-font-url"],"font-size":a["current-temp-font-size"],"is-bold":a["current-temp-bold"],
"is-italic":a["current-temp-italic"],color:a["current-temp-color"]}});$("#forecast-temp-font").fontPicker({"i18n-prefix":"forecast-temp-font",defaults:{font:a["forecast-temp-font"],"font-url":a["forecast-temp-font-url"],"font-size":a["forecast-temp-font-size"],"is-bold":a["forecast-temp-bold"],"is-italic":a["forecast-temp-italic"],color:a["forecast-temp-color"]}});$("#forecast-day-font").fontPicker({"i18n-prefix":"forecast-day-font",defaults:{font:a["forecast-day-font"],"font-url":a["forecast-day-font-url"],
"font-size":a["forecast-day-font-size"],"is-bold":a["forecast-day-bold"],"is-italic":a["forecast-day-italic"],color:a["forecast-day-color"]}});$("#address-font").fontPicker({"i18n-prefix":"address-font",defaults:{font:a["address-font"],"font-url":a["address-font-url"],"font-size":a["address-font-size"],"is-bold":a["address-bold"],"is-italic":a["address-italic"],color:a["address-color"]}});$("#humidity-font").fontPicker({"i18n-prefix":"humidity-font",defaults:{font:a["humidity-font"],"font-url":a["humidity-font-url"],
"font-size":a["humidity-font-size"],"is-bold":a["humidity-bold"],"is-italic":a["humidity-italic"],color:a["humidity-color"]}});$("#background-color").fontPicker({"i18n-prefix":"background-color",defaults:{color:c.getString("background-color")}})}else $("#current-temp-font").fontPicker({"i18n-prefix":"current-temp-font",defaults:{font:"Verdana","font-size":"60","is-bold":!0}}),$("#forecast-temp-font").fontPicker({"i18n-prefix":"forecast-temp-font",defaults:{font:"Verdana"}}),$("#forecast-day-font").fontPicker({"i18n-prefix":"forecast-day-font",
defaults:{font:"Verdana","is-bold":!0}}),$("#address-font").fontPicker({"i18n-prefix":"address-font",defaults:{font:"Verdana","font-size":"24","is-bold":!0}}),$("#humidity-font").fontPicker({"i18n-prefix":"humidity-font",defaults:{font:"Verdana"}}),$("#background-color").fontPicker({"i18n-prefix":"background-color",defaults:{color:""},visibility:{font:!1,"font-size":!1,variants:!1,text:!1}});$("#address").trigger("change");$("#description").trigger("change");$("#show-humidity").triggerHandler("click");
i18n.init({fallbackLng:"en"},function(a){$(".widget-wrapper").i18n().show();$(".form-control").selectpicker();$(".sticky-buttons").sticky({container:$(".widget-wrapper"),topSpacing:41,getWidthFrom:$(".widget-wrapper")})})})};
RiseVision.Weather.Settings.prototype.getSettings=function(){var b=document.getElementById("settings-alert"),a=!1,c="",c=null;$("#settings-alert").empty();"custom"==$("input[type='radio'][name='layout']:checked").val()&&(a=weather.settings.validateRequired($("#layout-url"),b,"Layout URL")?!0:a);a=weather.settings.validateRequired($("#current-temp-font .font-url"),b,"Current Temperature Font URL")?!0:a;a=weather.settings.validateRequired($("#forecast-temp-font .font-url"),b,"Forecast Temperature Font URL")?
!0:a;a=weather.settings.validateRequired($("#forecast-day-font .font-url"),b,"Forecast Day Font URL")?!0:a;a=weather.settings.validateRequired($("#address-font .font-url"),b,"Address URL")?!0:a;a=weather.settings.validateRequired($("#humidity-font .font-url"),b,"Humidity and Wind Font URL")?!0:a;a=weather.settings.validateRequired($("#custom-address"),b,"Your Custom Address")?!0:a;(a=weather.settings.validateRequired($("#custom-description"),b,"Your Custom Description")?!0:a)?($("#settings-alert").show(),
$(".widget-wrapper").scrollTop(0)):$("#terms").is(":checked")?(b=$("input[type='radio'][name='layout']:checked"),c="custom"==b.val()?$("#layout-url").val()+"?up_layout="+b.val():b.data("url")+"?up_layout="+b.val(),c+="&up_address="+$("#address").val()+"&up_custom-address="+$("#custom-address").val()+"&up_description="+$("#description").val()+"&up_unit="+$("#unit").val()+"&up_wind-speed="+$("#wind-speed").val()+"&up_background-color="+$("#background-color").data("font-picker").getColor(),c=$("#show-humidity").is(":checked")?
c+"&up_show-humidity=true":c+"&up_show-humidity=false",c=$("#terms").is(":checked")?c+"&up_terms=true":c+"&up_terms=false",c={params:c,additionalParams:JSON.stringify(weather.saveAdditionalParams())},$("#settings-alert").hide(),gadgets.rpc.call("","rscmd_saveSettings",null,c)):($("#settings-alert").html("Please accept the terms before saving.").show(),$(".widget-wrapper").scrollTop(0))};
RiseVision.Weather.Settings.prototype.saveAdditionalParams=function(){var b={},a=$("#current-temp-font").data("font-picker"),c=$("#forecast-temp-font").data("font-picker"),d=$("#forecast-day-font").data("font-picker"),e=$("#address-font").data("font-picker"),f=$("#humidity-font").data("font-picker");b["layout-url"]=$("#layout-url").val();b["custom-description"]=$("#custom-description").val();b["current-temp-font"]=a.getFont();b["current-temp-font-style"]=a.getFontStyle();b["current-temp-font-url"]=
a.getFontURL();b["current-temp-font-size"]=a.getFontSize();b["current-temp-bold"]=a.getBold();b["current-temp-italic"]=a.getItalic();b["current-temp-color"]=a.getColor();b["forecast-temp-font"]=c.getFont();b["forecast-temp-font-style"]=c.getFontStyle();b["forecast-temp-font-url"]=c.getFontURL();b["forecast-temp-font-size"]=c.getFontSize();b["forecast-temp-bold"]=c.getBold();b["forecast-temp-italic"]=c.getItalic();b["forecast-temp-color"]=c.getColor();b["forecast-day-font"]=d.getFont();b["forecast-day-font-style"]=
d.getFontStyle();b["forecast-day-font-url"]=d.getFontURL();b["forecast-day-font-size"]=d.getFontSize();b["forecast-day-bold"]=d.getBold();b["forecast-day-italic"]=d.getItalic();b["forecast-day-color"]=d.getColor();b["address-font"]=e.getFont();b["address-font-style"]=e.getFontStyle();b["address-font-url"]=e.getFontURL();b["address-font-size"]=e.getFontSize();b["address-bold"]=e.getBold();b["address-italic"]=e.getItalic();b["address-color"]=e.getColor();b["humidity-font"]=f.getFont();b["humidity-font-style"]=
f.getFontStyle();b["humidity-font-url"]=f.getFontURL();b["humidity-font-size"]=f.getFontSize();b["humidity-bold"]=f.getBold();b["humidity-italic"]=f.getItalic();b["humidity-color"]=f.getColor();return b};